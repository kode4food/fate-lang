from url import parse as parseURL
from pattern import NonEmptyString as URL

import 'node:http' as http
from './support' import createPromise

export def get(URL as url)
  createPromise(resolve ->
    let content = mutable('')

    let req = http.get(url | parseURL, (res) ->
      res.on('data', data ->
        content.value + data | content.set
      )
      res.on('end', ->
        content.value | resolve
      )
    )
  )
end
