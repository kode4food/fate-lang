import nodeunit

from test import equalTo, deepEqualTo, isOk

def basics(test)
  let x = do
    await timeout(200)
    'hello'
  end

  do
    await x | equalTo("hello")
    test.done()
  end
end

def awaitAny(test)
  let arr = [timeout(100), timeout(10), timeout(50)]

  do
    await any arr | equalTo(10)
    test.done()
  end
end

def awaitAll(test)
  let arr = [timeout(100), timeout(10), timeout(50)]

  do
    await all arr | deepEqualTo([100, 10, 50])
    test.done()
  end
end

export let tests = nodeunit.testCase({
  "Basic Do Functionality": basics,
  "Await Any Functionality": awaitAny,
  "Await All Functionality": awaitAll
})
