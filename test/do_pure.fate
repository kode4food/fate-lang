import nodeunit

from test import equalTo, deepEqualTo

def basics(test)
  let x = do
    await timeout(200)
    'hello'
  end

  do
    await x | equalTo("hello")
    test.done()
  end
end

def awaitAny(test)
  let arr = [
    for x in [100, 10, 50]
    select x | timeout
  ]

  do
    await any arr | equalTo(10)
    test.done()
  end
end

def awaitAll(test)
  let arr = [
    for x in [100, 10, 50]
    select x | timeout
  ]

  do
    await all arr | deepEqualTo([100, 10, 50])
    test.done()
  end
end

export let tests = nodeunit.testCase({
  "Basic Do Functionality": basics,
  "Await Any Functionality": awaitAny,
  "Await All Functionality": awaitAll
})
